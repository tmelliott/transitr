
## Make this C++11 so that we get better int64 support and much more
CXX_STD=CXX11

CURL_LIBS=-lcurl

## Configure tells us about locations for ## both Rcpp (ie libRcpp.so and Rcpp.h) and 
## ProtoBuf headers and library via these variables
PKG_CPPFLAGS=@PKG_CPPFLAGS@
PKG_LIBS=@PKG_LIBS@ $(CURL_LIBS)


PROTOFILES = gtfs-realtime.pb.cc vendor/protobuf/gtfs-realtime.pb.h
.PHONY: $(shlib)

all: $(shlib)

realtime_main.o: $(PROTOFILES)
SRC = $(wildcard *.cpp)
OBJ = $(patsubst %.cpp, %.o, $(SRC))
OBJECTS = gtfs-realtime.pb.o $(OBJ)

$(PROTOFILES): vendor/protobuf/gtfs-realtime.proto
	protoc -I=. --cpp_out=. $^
	mv vendor/protobuf/gtfs-realtime.pb.cc .
