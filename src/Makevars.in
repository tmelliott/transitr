
## Make this C++11 so that we get better int64 support and much more
CXX_STD=CXX11

CURL_LIBS=-lcurl

## Configure tells us about locations for ## both Rcpp (ie libRcpp.so and Rcpp.h) and 
## ProtoBuf headers and library via these variables
PKG_CPPFLAGS=@PKG_CPPFLAGS@
PKG_LIBS=@PKG_LIBS@ $(CURL_LIBS)


PROTOFILES = gtfs-realtime.pb.cpp vendor/protobuf/gtfs-realtime.pb.h
.PHONY: $(shlib)

all: $(shlib)

OBJECTS = construct_network.o geo.o process_shape.o realtime_main.o \
	test-geo.o test-runner.o RcppExports.o gtfs-realtime.pb.o

realtime_main.o: gtfs-realtime.pb.o
gtfs-realtime.pb.o: gtfs-realtime.pb.cpp
$(PROTOFILES): vendor/protobuf/gtfs-realtime.proto
	protoc -I=. --cpp_out=. $^
	mv vendor/protobuf/gtfs-realtime.pb.cc gtfs-realtime.pb.cpp
