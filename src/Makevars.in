
## Make this C++11 so that we get better int64 support and much more
CXX_STD=CXX11
CURL_LIBS=-lcurl

PKG_CPPFLAGS=@PKG_CPPFLAGS@ 
PKG_LIBS=@PKG_LIBS@ $(CURL_LIBS) 

PROTOFILES = gtfs-realtime.pb.cpp vendor/protobuf/gtfs-realtime.pb.h


$(SHLIB): $(OBJECTS)

OBJECTS =  geo.o gtfs.o time.o \
    process_shape.o construct_network.o \
    realtime_main.o \
    test-time.o test-geo.o test-gtfs.o test-runner.o RcppExports.o \
    gtfs-realtime.pb.o \
    vendor/sqlite3/sqlite3.o

$(PROTOFILES): vendor/protobuf/gtfs-realtime.proto
	protoc -I=. --cpp_out=. $^
	mv vendor/protobuf/gtfs-realtime.pb.cc gtfs-realtime.pb.cpp
